# 机器学习第二章作业

2.1 数据集包含 1000 个样本，其中 500 个正例、 500 个反例，将其划分为包含 70% 样本的训练集和 30% 样本的测试集用于留出法评估，估算有多少种划分方式

训练/测试集的划分要尽可能保存数据分布一致，故训练集中应该包括 350 个正例和 350 个反例，剩余的作测试集，那么划分方式应该有 $ (x_{500}^{350})^{2} $种。

2.5 试证明(2.22) $ AUC=1−lrank$

显然，在ROC曲线中，一条横线对应一个（或多个）负样本 $ x_{i}^{-} $ ， 一条竖线对应一个（或多个）正样本 $ x_{j}^{+} $ ， 而一条斜线则对应多个正负样本 $ x^{+}_{\ast},x^{-}_{\ast} $ ，且 $ f(x^{+}_{*}) = f(x^{-}_{\ast}) $ ，即样本的预测值相同。

其中 $ m_{i}^{+} $ 对应一个（或多个预测值相同的）正例，而 $ m_{j} $ 对应多个预测值相同的正负例 $ x^{+}_{\ast},x^{-}_{\ast} $ ， 显然阴影部分的宽为 $ \frac{\sum_{x^{-}\in D^{-}} \parallel(f(x^{-}) = f(m_{j}))} {m^{-}} $ , $ m_{i}^{+} $ 的纵坐标为 $ \frac{\sum_{x_{+}\in D^{+}}\parallel(f(x^{+})>f(m_{j}))}{m^{+}} $ ，而 $ m_{j} $ 纵坐标为 $ \frac{\sum_{x_{+}\in D^{+}}\parallel(f(x^{+})>f(m_{j}))}{m^{+}} + \frac{\sum_{x_{+}\in D^{+}}\parallel(f(x^{+})=f(m_{j}))}{m^{+}} $ ， 于是阴影部分面积则为 $ \frac{(\sum_{x^{-}\in D^{-}} \parallel(f(x^{-}) = f(m_{j})))\ast(\sum_{x^{+}\in D^{+}} (\frac{1}{2}\parallel(f(x^{+}) = f(m_{j}))+\parallel(f(x^{+}) > f(m_{j})))} {m^{-}m^{+}} $

令 $ D^{-}_{|f(D^{-})|} $ 表示预测值唯一的负例集合，即原负例集合中以预测值 $ f(x) $ 去重， 那么AUC值为： $ \sum_{m \in D^{-}_{|f(D^{-})|}}\frac{(\sum_{x^{-}\in D^{-}} \parallel(f(x^{-}) = f(m)))\ast (\sum_{x^{+}\in D^{+}} (\frac{1}{2}\parallel(f(x^{+}) = f(m))+\parallel(f(x^{+}) > f(m)))} {m^{-}m^{+}} $ 其中 $ \sum_{m \in D^{-}_{|f(D^{-})|}} (\sum_{x^{-}\in D^{-}} \parallel(f(x^{-}) = f(m))) \ast \sum_{x^{+}\in D^{+}} \parallel(f(x^{+}) = f(m)) = \sum_{x^{+}\in D^{+}}\sum_{x^{-}\in D^{-}} \parallel(f(x^{+}) = f(x^{-})) $

而 $ \sum_{m \in D^{-}_{|f(D^{-})|}} (\sum_{x^{-}\in D^{-}} \parallel(f(x^{-}) = f(m))) \ast \sum_{x^{+}\in D^{+}} \parallel(f(x^{+}) > f(m)) = \sum_{x^{+}\in D^{+}}\sum_{x^{-}\in D^{-}} \parallel(f(x^{+}) > f(x^{-})) $

于是 $ AUC = \frac{1}{m^{+}m^{-}}\sum_{x^{+}\in D^{+}}\sum_{x^{-}\in D^{-}} (\parallel(f(x^{+}) > f(x^{-})) + \frac{1}{2}\parallel(f(x^{+}) = f(x^{-}))) $

于是 $ AUC + l_{rank} = 1 $

2.7 试证明任意一条ROC曲线都有一条代价曲线与之对应，反之亦然

首先“任意一条ROC曲线都有一条代价曲线与之对应”，显然ROC曲线上每个点（FPR，TPR）都对应着一条线段，取所有线段的下届，即可得到唯一的代价曲线。

反之，代价曲线实际上是一个多边形（在有限样本下），显然，每条边都对应代价平面上一条线段，实际上从左向右遍历每一条边，即可得到ROC曲线上从左到右每一个点。
